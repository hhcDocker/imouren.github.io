---
layout: post
title:  "贝叶斯定理"
date:   2017-04-25 09:15:31
categories: python bayes
tags: python bayes
---

* content
{:toc}



### 条件概率

条件概率通常记作:  `p(A|B)`，表示在给定B的条件下，A事件发生的概率。

### 联合概率

是指两个事件同时发生的概率。

$$p(A\ and\ B) = p(A)p(B)$$

只有在A和B都是独立事件的时候成立。

如果A和B不是独立事件，比如A今天下雨和B明天下雨。

公式修正为：

$$p(A\ and\ B) = p(A)p(B|A)$$


### 贝叶斯定理

联合概率的乘积是可以交换的（乘法交换律）


$$p(A\ and\ B) = p(B\ and\ A)$$

然后我们写下条件概率的表达式

$$p(A\ and\ B) = p(A)p(B|A)$$


交换A和B

$$
p(B\ and\ A) = p(B)p(A|B)
$$

将表达式连起来

$$
  p(B)p(A|B) = p(A)p(B|A)
$$

已知p(B)，求`p(A|B)`，两边都除以p(B)，则：

$$
  p(A|B) = \frac{p(A)p(B|A)} {p(B)}
$$


### 曲奇饼问题

有两碗饼干，碗1中有30个香草味的饼干和10个巧克力味饼干，碗2中有上述饼干各20个。我们在不看的情况下，随机挑一个碗拿一个饼干，得到一个香草味饼干，问，这个饼干来自碗1的概率？

假设p(B1)是来自碗1的概率，p(V)表示饼干是香草味的概率。

根据贝叶斯定理得到：

$$
  p(B1|V) = \frac{p(B1)p(V|B1)} {p(V)}
$$

* p(B1) 碗是随机选的所以为0.5
* `p(V|B1)` 碗1总共40个饼，30个香草味，所以为30/40 = 3/4
* p(V) 从任意一个碗取到香草味饼干的概率 50/80 = 5/8

将数值带入公式

$$
  p(B1|V) = \frac{\frac12 * \frac34} {\frac58} = \frac35
$$


### 历时诠释

还有另外一种理解贝叶斯公式的思路：数据集D的内容变化的时候更新假设概率H的方法。

考虑H和D的情况下，将贝叶斯公式写为：

$$
  p(H|D) = \frac{p(H)p(D|H)} {p(D)}
$$

这里解释每一项的意义：

* `p(H)`为**先验概率**，即得到新数据前的某一假设概率。
* `p(H|D)`为**后验概率**，即看到新数据后，我们计算该假设的概率。
* `p(D|H)`为**似然度**，在该假设下得到这一数据的概率。
* `p(D)` 为任何假设下得到这一数据的概率，为**标准化常量**


